### 7-day Moving Average (Strictly Calculated)
```sql
USE salesorderssample;

SELECT *
      ,SUM(OrderTotal) AS DailyOrderTotal/*
      ,AVG(SUM(OrderTotal))
		     OVER(ORDER BY OrderDate
		          ROWS BETWEEN 6 PRECEDING
					          AND CURRENT ROW) AS Day7AVG*/
		,CASE WHEN 7 = COUNT(*)
		                   OVER(ORDER BY OrderDate
		                            ROWS BETWEEN 6 PRECEDING
					                            AND CURRENT ROW)
	         THEN AVG(SUM(OrderTotal))
		               OVER(ORDER BY OrderDate
		                        ROWS BETWEEN 6 PRECEDING
					                        AND CURRENT ROW) END AS Day7AVG
FROM ORDERS
GROUP BY OrderDate
ORDER BY OrderDate
LIMIT 20
```
| OrderNumber | OrderDate | ShipDate | CustomerID | EmployeeID | OrderTotal | DailyOrderTotal | Day7AVG | 
| ---: | --- | --- | ---: | ---: | ---: | ---: | ---: | 
| 1 | 2015-09-01 | 2015-09-04 | 1018 | 707 | 12751.85 | 52083.52 | \N | 
| 11 | 2015-09-02 | 2015-09-04 | 1020 | 706 | 11070.65 | 56111.08 | \N | 
| 21 | 2015-09-03 | 2015-09-03 | 1014 | 702 | 709.97 | 34505.04 | \N | 
| 26 | 2015-09-04 | 2015-09-08 | 1013 | 707 | 7266.93 | 23538.34 | \N | 
| 31 | 2015-09-05 | 2015-09-09 | 1014 | 701 | 162.96 | 11276.12 | \N | 
| 34 | 2015-09-06 | 2015-09-07 | 1010 | 705 | 411.28 | 5513.88 | \N | 
| 37 | 2015-09-07 | 2015-09-11 | 1027 | 702 | 1718.78 | 41061.98 | 32012.851429 | 
| 45 | 2015-09-08 | 2015-09-08 | 1008 | 708 | 17889.25 | 28117.57 | 28589.144286 | 
| 52 | 2015-09-09 | 2015-09-11 | 1001 | 701 | 261.90 | 60765.25 | 29254.025714 | 
| 62 | 2015-09-10 | 2015-09-13 | 1003 | 703 | 1335.50 | 45789.85 | 30866.141429 | 
| 68 | 2015-09-11 | 2015-09-12 | 1027 | 702 | 273.54 | 3307.79 | 27976.062857 | 
| 70 | 2015-09-12 | 2015-09-16 | 1016 | 706 | 595.20 | 34909.76 | 31352.297143 | 
| 78 | 2015-09-13 | 2015-09-16 | 1007 | 701 | 13498.95 | 68412.17 | 40337.767143 | 
| 88 | 2015-09-14 | 2015-09-17 | 1026 | 707 | 960.30 | 25136.89 | 38062.754286 | 
| 95 | 2015-09-15 | 2015-09-19 | 1021 | 704 | 9959.15 | 52230.75 | 41507.494286 | 
| 105 | 2015-09-16 | 2015-09-18 | 1005 | 704 | 9345.15 | 11501.55 | 34469.822857 | 
| 110 | 2015-09-17 | 2015-09-19 | 1015 | 708 | 641.96 | 12453.11 | 29707.431429 | 
| 112 | 2015-09-18 | 2015-09-19 | 1009 | 703 | 414.00 | 6511.35 | 30165.082857 | 
| 115 | 2015-09-19 | 2015-09-21 | 1003 | 704 | 799.00 | 5276.65 | 25931.781429 | 
| 117 | 2015-09-20 | 2015-09-22 | 1005 | 705 | 10579.00 | 43706.87 | 22402.452857 | 
